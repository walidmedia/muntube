{% load static %}
{% load social_share %}

{% include 'base.html' %}
<style>

#subscribe-btn {
  background-color: blue;
  color: white;
}

#subscribe-btn.subscribed {
  background-color: green;
}


    .like-button {
  background-color: transparent;
  border: none;
  cursor: pointer;
}

.like-button .fa-heart {
  color: red;
  font-size: 20px;
}

.like-button .like-count {
  font-size: 20px;
  margin-left: 5px;
}

    .comment-text {
    font-size: 13px
}
.wish {
    color: #35b69f
}

.user-feed {
    font-size: 14px;
    margin-top: 12px
}
.nav-pills .nav-link.active, .nav-pills .show>.nav-link {
    color: #fff;
    background-color: #B88E6D;
}
.nav-link {
    display: block;
    padding: 0.5rem 1rem;
    color: #ffffff;
    transition: color 0.15s ease-in-out,background-color 0.15s ease-in-out,border-color 0.15s ease-in-out;
}
:root {
    --primary: #B88E6D;
    --secondary: #191C24;
    --light: #6C7293;
    --dark: #000000;
}
.overlay {
  position: fixed;
  top: 50px;
  background: rgba(0, 0, 0, 0.5);
  color: #f1f1f1;
  width: auto;
  padding: 20px;
}

</style>
<title>Muntube</title>
{% block content %}
   <div class="justify-content-between">
        <div class="row justify-content-between">
            <div class="col-sm-12 col-md-12 col-xl-8">
            <div class=" bg-secondary rounded ">
            {% for v in video %}
                <div class="row d-flex col-xl-12 video_box">
                        <video width="100%" class=" embed-responsive embed-responsive-16by9 col-md-12" poster="" controls="controls" >
                            <source src="{{ v.vid.url }}" type="video/mp4" />
                                <track
                            label="English"
                            kind="subtitles"
                            srclang="en"
                            src="captions/vtt/sintel-en.vtt"
                            default />
                                <track
                                label="Deutsch"
                                kind="subtitles"
                                srclang="de"
                                src="captions/vtt/sintel-de.vtt" />
                                <track
                                label="Español"
                                kind="subtitles"
                                srclang="es"
                                src="captions/vtt/sintel-es.vtt" />
                        </video>

                    <div class="col-sm-12 col-md-12 col-xl-12">
                      <div style="background-color: #191C24; " class="card mb-2">
                        <h5 class="card-header" style="color: #fdecdd">{{ v.title }}</h5>



                       <span class="container-fluid fw-semibold" style="color: #6e6a69">{{ v.views }} views • {{ v.date_created.date |date:"d/m/Y" }}</span>
                      <hr class="mt-2">
                        <div class="card-body">
                        <div class="container-fluid">
                            <div class="row ">
                            <table class="mt-0">
                                <tr>
                                    <td>
                                    <button id="like_button" style="background-color: #533f03" data-bs-toggle="dropdown" class=" btn rounded-pill btn-outline-secondary btn-xs align-content-center" >
                                        <i class="fa fa-heart"></i>
                                    </button>
                                     <span id="likes" class="align-middle small" style="color: #fdecdd">{{ v.likes }} J'aimes</span>
                                    <script>
                                    const likeButton = document.querySelector('#like_button');
                                    likeButton.addEventListener('click', function() {
                                        fetch(`{% url 'like_video' v.id %}`)
                                        .then(response => response.json())
                                        .then(data => {
                                            const likesElement = document.querySelector('#likes');
                                            likesElement.innerHTML = `${data.likes} J'aimes`;
                                        });
                                    });
                                    </script>
                                    </td>
                                    <td>
                                         <button style="background-color: #533f03" data-bs-toggle="dropdown" class=" btn rounded-pill btn-outline-secondary btn-xs align-content-center" >
                                            <i class="fa fa-share"></i>
                                        </button>
                                         <span class="align-middle small" style="color: #fdecdd"> Partager</span>
                                        <div class="dropdown-menu dropdown-menu bg-black border-0 rounded-2 rounded-bottom m-0">
                                            <form>
                                             {% csrf_token %}
                                            <button type="button" class="btn btn-square btn m-2">
                                                    {% post_to_facebook object_or_url "<span style='color: green;'><i class='fab fa-facebook fa-2x' style='color: #3b5998;'></i></span>" %}
                                            </button>
                                                <button type="button" class="btn btn-square btn m-2">
                                                    {% post_to_twitter v.title object_or_url "<span style='color: green;'><i class='fab fa-twitter fa-2x' style='color: #55acee;'></i></span>" %}</button>
                                                </button>
                                                <button type="button" class="btn btn-square btn m-2">
                                                    {% send_email v.title v.detail  object_or_url "<span style='color: green;'><i class='fab fa-google fa-2x' style='color: #dd4b39;'></i></span>" %}</button>
                                                </button>
                                                <button type="button" class="btn btn-square btn m-2">
                                                    {% post_to_whatsapp  object_or_url "<span style='color: green;'><i class='fab fa-whatsapp fa-2x' style='color: #25d366;'></i></span>" %}</button>
                                                </button>
                                                <button type="button" class="btn btn-square btn m-2">
                                                    {% post_to_telegram v.title object_or_url "<span style='color: green;'><i class='fab fa-telegram fa-2x' style='color: #095d9a;'></i></span>" %}</button>
                                                </button>
                                        </form>
                                        </div>
                                    </td>
                                    <td>
                                    <button style="background-color: #533f03" data-bs-toggle="dropdown" class=" btn rounded-pill btn-outline-secondary btn-xs align-content-center" >
                                        <i class="fa fa-ellipsis-v"></i>
                                    </button>
                                    <div class="dropdown-menu dropdown-menu-end bg-black border-0 rounded-0 rounded-bottom m-0">
                                        {% if user.is_authenticated %}
                                        <form>
                                             {% csrf_token %}
                                            <button class="dropdown-item" type="submit" value="{{ v.id }}" name="id_video">
                                                <i class="fa fa-flag me-3"></i><span class="align-middle text-black">Signaler</span>
                                            </button>
                                        </form>
                                        <form action="{% url 'save_video' v.pk %}" method="post">
                                            {% csrf_token %}
                                            <button class="dropdown-item" type="submit" value="{{ v.id }}" name="id_video">
                                                <i class="fa fa-save me-3"></i><span class="align-middle text-black">À regarder</span>
                                            </button>
                                        </form>
                                        {% else %}
                                            <form>
                                             {% csrf_token %}
                                                <button class="dropdown-item" type="submit" value="{{ v.id }}" name="id_video">
                                                    <i class="fa fa-flag me-3"></i><span class="align-middle text-black">Signaler</span>
                                                </button>
                                            </form>
                                            <form action="{% url 'login' %}" method="post">
                                                {% csrf_token %}
                                                <button class="dropdown-item" type="submit" value="{{ v.id }}" name="id_video">
                                                    <i class="fa fa-save me-3"></i><span class="align-middle text-black">Enregistrer</span>
                                                </button>
                                                </form>
                                        {% endif %}
                                    </div>
                                    </td>
                                </tr>
                            </table>
                            </div>
                        </div>
                        <hr>
                        <div class="">
                            <div class="row">
                                <table>
                                    <tr>

                                        <td class="text-center" rowspan="2">
                                            <a href="{% url 'chaine_profile' v.user.id %}">
                                                <img id="img" width="48" src="{{ v.user.photo.url }}" class="rounded-circle">
                                            </a>
                                        </td>
                                        <td colspan="2">
                                             <span style="color:white;">
                                                <a href="{% url 'chaine_profile' v.user.id %}" class="text-white">
                                                    <b>{{ v.user.first_name }}</b>
                                                </a>

                                                  {% if don_par_user.total_payments <= 10 %}
                                                  <i class="fas fa-gem" style="color: #d39e00"></i>
                                                  {% elif don_par_user.total_payments <= 15 %}
                                                  <i class="fas fa-gem" style="color: #d39e00"></i>
                                                  <i class="fas fa-gem" style="color: #d39e00"></i>
                                                  {% elif don_par_user.total_payments <= 20 %}
                                                  <i class="fas fa-gem" style="color: #d39e00"></i>
                                                  <i class="fas fa-gem" style="color: #d39e00"></i>
                                                  <i class="fas fa-gem" style="color: #d39e00"></i>
                                                  {% elif don_par_user.total_payments > 20 %}
                                                  <i class="fas fa-gem" style="color: #d39e00"></i>
                                                  <i class="fas fa-gem" style="color: #d39e00"></i>
                                                  <i class="fas fa-gem" style="color: #d39e00"></i>
                                                  <i class="fas fa-gem" style="color: #d39e00"></i>
                                                  {% endif %}
                                             </span>
                                        </td>
                                        <td rowspan="2">
                                            {% if user.is_authenticated %}

                                    <button id="subscribe-btn" onclick="subscribe()">Subscribe</button>

                                    <script>
                                    function subscribe() {
                                      // Make an AJAX call to the Django view that handles subscriptions
                                      $.post('/subscribe/', {channel_id: CHANNEL_ID}, function(response) {
                                        // If the subscription was successful, change the button color and text
                                        if (response.success) {
                                          $('#subscribe-btn').addClass('subscribed').text('Subscribed');
                                        }
                                      });
                                    }

                                    </script>

                                            {% else %}
                                                <form action="{% url 'login' %}" method="post">
                                                    {% csrf_token %}
                                                    <button style="background-color: #533f03" type="submit" name="chaine_id" value="{{ v.user.id }}" class="btn rounded-pill btn-outline-secondary">
                                                        <i class="fa fa-bell"></i>
                                                        <span style="color: white">S'abonner</span>
                                                    </button>
                                                </form>
                                            {% endif %}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <span style="color:white">111 abonnés</span>
                                        </td>
                                    </tr>
                                </table>
                                <div class="col-sm-4 col-md-4 col-xl-1">
                                </div>
                            </div>
                        </div>

                        <div class="row">

                            <div class="text-center mb-4 mt-3">
                                <script src="https://js.stripe.com/v3/"></script>
                                    <form action="{% url 'proced_don' v.id %}" method="post">
                                      {% csrf_token %}
                                    <input class="me-3" type="button" onclick="decrement()" style="font-size: 50px;background: transparent;border: 0;color: white" value="-" />
                                    <input class="me-3 mb-3" style="width: 130px; font-size: 50px; height: 130px; border: 2px solid #B88E6D;background-color: #191C24;color: white;border-radius: 50%;display: inline-block;text-align: center;"  type="text" name="don" id="don" value="10">
                                    <input type="button" onclick="increment()" style="font-size: 50px;background: transparent;border: 0;color: white" value="+" />
                                    <p class="mb-3" style="position: absolute;right: 40px;">
                                        <button id="stripe-button" type="submit" class="btn rounded-pill btn-outline-secondary" style="background-color: #B88E6D; color: white; font-size: small">
                                            <strong>Suivant</strong>
                                        </button>
                                    </p>

                                    </form>
                                <script type="text/javascript">
                                    var counter = 10;
                                    function increment(){
                                        counter = counter+5;
                                        document.getElementById('don').value = counter;
                                    }
                                    function decrement(){
                                        counter = counter-5;
                                        if(counter<5){
                                            counter=5;
                                        }
                                        document.getElementById('don').value = counter;
                                    }
                                </script>
                            </div>

                         </div>

                        <div class="mt-5" style="color: #b9b7b7">
                            <p>{{ v.detail }}
                            </p>
                        </div>
                        </div>
                      </div>
                    <div class="col-sm-12 col-xl-12">
                        <div class="bg-secondary rounded h-100 mt-2">
                        {% if v.link %}
                            <ul class="nav nav-pills mb-3 pl-1" id="pills-tab" role="tablist">
                                <li class="nav-item me-2" role="presentation">
                                    <button class="nav-link rounded-pill active small" id="pills-home-tab" data-bs-toggle="pill"
                                        data-bs-target="#pills-home" type="button" role="tab" aria-controls="pills-home"
                                        aria-selected="true"
                                    >
                                        <strong  style="font-size: 14px">Liens & documents</strong>
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation" >
                                    <button class="nav-link rounded-pill small" id="pills-profile-tab" data-bs-toggle="pill"
                                        data-bs-target="#pills-profile" type="button" role="tab"
                                        aria-controls="pills-profile" aria-selected="false"
                                     >
                                        <strong class="me-1"><span style="font-size: 14px" class="me-1">{{ comments }}</span>Commentaires</strong>
                                    </button>
                                </li>
                            </ul>
                            <div class="tab-content" id="pills-tabContent">
                                <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab" >
                                    <div class="col-sm-12 col-xl-12 mt-3">
                                        <div class="bg-secondary rounded h-100 p-4">
                                        <h6 class="border-bottom" style="color: #6e6a69">Liens Utiles</h6>
                                            {% if v.link %}
                                                <p style="color: #ffffff "><span><i class="fa fa-link me-3 text-white"></i></span>liens pour telecharger l'outils de tuto <a style="color: #B88E6D" href="{{ v.link }}">{{ v.link }}</a>.</p>
                                                <hr>
                                            {% endif %}
                                        </div>
                                    </div>
                                    <div class="col-sm-12 col-xl-12">
                                        <div class="bg-secondary rounded h-100 p-4">
                                        <h6 class="border-bottom" style="color: #6e6a69">documents</h6>
                                            {% if v.documents %}
                                                <p style="color: white  "><i class="fa fa-file me-3"></i> Ouvrir le fichier PDF <a style="color:#B88E6D " href="{{ v.documents.url }}">cicilisation egypte</a>.</p>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">
                                    <section>
                                      <div class="my-2 ">
                                        <div class="row d-flex justify-content-center">
                                          <div class="col-md-12 col-lg-12">
                                            <div style="background-color: #191C24; font-size: small " class="card text-dark">

                                                  <div class="card-body ">

                                                  <form action="{% url 'commenter' v.id %}" method="post">
                                                          {% csrf_token %}
                                                          <div class="d-flex flex-start mb-3">
                                                            <!--<img src="{{ user.photo.url }}" width="40" height="40" class="rounded-circle shadow-1-strong me-3">-->
                                                            <input name="video" type="hidden" value="{{ v.id }}">
                                                            <input name="user" type="hidden" value="{{ user.id}}">
                                                            <input name="sujet" type="hidden" value="{{ c.name }}">
                                                              <form>
                                                                <input name="commentaire" type="text" class="form-control" placeholder="Entrez votre commentaire..."
                                                                style="  width: 100%;padding: 10px;font-size: 16px;border: none;border-radius: 5px 0 0 5px;">
                                                                  <button class="btn btn-outline-secondary" type="submit" style=" width: 10%;padding: 10px;background-color: #000000;color: #fff;border: none;border-radius: 0 5px 5px 0;cursor: pointer;transition: all 0.3s ease;">
                                                                      <i class="fa fa-arrow-right"></i>
                                                                  </button>
                                                                </form>
                                                              <!--<button class="btn btn-outline-secondary" style="background: #533f03; color: white"  type="submit"><i class="fa fa-arrow-right"></i></button>
                                                            <input style="background: #533f03; color: white" type="submit" value="Commenter" class="btn rounded-pill btn-outline-secondary">-->
                                                          </div>
                                                      </form>
                                                      {% for c in comm %}
                                                          {% if c.video.id == v.id %}
                                                            <!--<p class="fw-light mb-4 pb-2">Latest Comments section by users</p>-->

                                                            <div style="color: #b9b7b7" class="d-flex flex-start">
                                                              <img class="rounded-circle shadow-1-strong me-3"
                                                                src="{{ c.user.photo.url }}" alt="avatar" width="40"
                                                                height="40" />
                                                              <div class="comment">
                                                                <span class="fw-bold mt-0"><strong style="color:#fff;">
                                                                    {{ c.user.username }}</strong>

                                                                    {% if don_par_user.total_payments <= 10 %}
                                                                      <i class="fas fa-gem" style="color: #d39e00"></i>
                                                                      {% elif don_par_user.total_payments <= 15 %}
                                                                      <i class="fas fa-gem" style="color: #d39e00"></i>
                                                                      <i class="fas fa-gem" style="color: #d39e00"></i>
                                                                      {% elif don_par_user.total_payments <= 20 %}
                                                                      <i class="fas fa-gem" style="color: #d39e00"></i>
                                                                      <i class="fas fa-gem" style="color: #d39e00"></i>
                                                                      <i class="fas fa-gem" style="color: #d39e00"></i>
                                                                      {% elif don_par_user.total_payments > 20 %}
                                                                      <i class="fas fa-gem" style="color: #d39e00"></i>
                                                                      <i class="fas fa-gem" style="color: #d39e00"></i>
                                                                      <i class="fas fa-gem" style="color: #d39e00"></i>
                                                                      <i class="fas fa-gem" style="color: #d39e00"></i>
                                                                      {% endif %}

                                                                 <div class="mt-0" style="font-size: 10px">{{ c.date_added | date:"d/m/Y" }}|{{ c.date_added|time:"H:i:s" }}</div>
                                                                </span>
                                                                <div class="d-flex align-items-center mt-0 mb-0">


                                                                   <!-- <a href="#!" class="link-muted"><i class="bx bx-heart ms-2"></i></a>-->
                                                                </div>
                                                                <span style="color: #fdecdd;font-size: 14px;" class="mb-0">
                                                                  {{ c.contenue }}
                                                                </span>

                                                              </div>
                                                            </div>

                                                            <!--<button id="like-button" style="background-color: #533f03;background-color: transparent"  data-comment-id="{{ c.pk }}" class="like-button btn rounded-pill btn-outline-secondary btn-xs align-content-center" >
                                                                <i class="fa fa-heart"></i>
                                                            </button>-->
                                                          <div class="like-section">
                                                            <button class="like-button" data-comment-id="{{ c.id }}">
                                                              <i class="fa fa-heart"></i>
                                                            </button>
                                                            <span class="like-count text-white">{{ c.likes }}</span>
                                                          </div>
                                                            <script>
                                                           document.addEventListener('click', function(event) {
  if (!event.target.classList.contains('like-button')) {
    return;
  }

  const commentId = event.target.dataset.commentId;
  const url = '/like_comment/' + commentId;

  // Send an AJAX request to the server to update the like count
  fetch(url, {
    method: 'POST',
    headers: {
      'X-CSRFToken': getCookie('csrftoken'),
      'Content-Type': 'application/json',
      'Accept': 'application/json'
    }
  })
  .then(response => response.json())
  .then(data => {
    // Update the like count in the HTML
    const commentElement = document.getElementById('comment-' + commentId);
    const likeCountElement = commentElement.querySelector('.like-count');
    likeCountElement.textContent = data.likes;
  });
});

// Helper function to get the value of a cookie
function getCookie(name) {
  const value = `; ${document.cookie}`;
  const parts = value.split(`; ${name}=`);
  if (parts.length === 2) {
    return parts.pop().split(';').shift();
  }
}
document.addEventListener("click", function(event) {
  if (event.target.classList.contains("like-button")) {
    var commentId = event.target.dataset.commentId;

    axios.post("/like_comment/", {
      comment_id: commentId
    })
    .then(function(response) {
      if (response.data.liked) {
        event.target.innerHTML = "&#9829;";
      } else {
        event.target.innerHTML = "&#9825;";
      }
    })
    .catch(function(error) {
      console.log(error);
    });
  }
});
const replyButtons = document.querySelectorAll('.reply-button');
replyButtons.forEach((button) => {
  button.addEventListener('click', (event) => {
    const replyForm = event.target.nextElementSibling;
    replyForm.style.display = 'flex';
  });
});



                                                            </script>
                                                            <hr style="color:#b9b7b7;" class="mb-3">
                                                          {% endif %}
                                                      {% endfor %}
                                                  </div>
                                                  <hr class="mt-0" />
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                    </section>
                                </div>
                            </div>
                        {% else %}
                            <ul class="nav nav-pills mb-1 pl-1" id="pills-tab" role="tablist">
                                <li class="nav-item" role="presentation" >
                                    <button class="nav-link rounded-pill active small" id="pills-profile-tab" data-bs-toggle="pill"
                                        data-bs-target="#pills-profile" type="button" role="tab"
                                        aria-controls="pills-profile" aria-selected="false"
                                     >
                                        <strong class="me-1"><span style="font-size: 12px" class="me-1">{{ comments }}</span>Commentaires</strong>
                                    </button>
                                </li>
                            </ul>
                            <div class="tab-content" id="pills-tabContent">
                                <div class="tab-pane fade show active" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">
                                    <section>
                                      <div class="my-2 ">
                                        <div class="row d-flex justify-content-center">
                                          <div class="col-md-12 col-lg-12">
                                            <div style="background-color: #191C24; font-size: small " class="card text-dark">

                                                  <div class="card-body p-4">

                                                  <form action="{% url 'commenter' v.id %}" method="post">
                                                          {% csrf_token %}
                                                          <div class="d-flex flex-start mb-4">
                                                            <!--<img src="{{ user.photo.url }}" width="40" height="40" class="rounded-circle shadow-1-strong me-3">-->
                                                            <input name="video" type="hidden" value="{{ v.id }}">
                                                            <input name="user" type="hidden" value="{{ user.id}}">
                                                            <input name="sujet" type="hidden" value="{{ c.name }}">
                                                              <form>
                                                                <input name="commentaire" type="text" class="form-control" placeholder="Entrez votre commentaire..."
                                                                style="  width: 100%;padding: 10px;font-size: 16px;border: none;border-radius: 5px 0 0 5px;">
                                                                  <button class="btn btn-outline-secondary" type="submit" style=" width: 10%;padding: 10px;background-color: #000000;color: #fff;border: none;border-radius: 0 5px 5px 0;cursor: pointer;transition: all 0.3s ease;">
                                                                      <i class="fa fa-arrow-right"></i>
                                                                  </button>
                                                                </form>
                                                              <!--<button class="btn btn-outline-secondary" style="background: #533f03; color: white"  type="submit"><i class="fa fa-arrow-right"></i></button>
                                                            <input style="background: #533f03; color: white" type="submit" value="Commenter" class="btn rounded-pill btn-outline-secondary">-->
                                                          </div>
                                                      </form>
                                                      {% for c in comm %}
                                                          {% if c.video.id == v.id %}
                                                            <!--<p class="fw-light mb-4 pb-2">Latest Comments section by users</p>-->

                                                            <div style="color: #b9b7b7" class="d-flex flex-start">
                                                              <img class="rounded-circle shadow-1-strong me-3"
                                                                src="{{ c.user.photo.url }}" alt="avatar" width="40"
                                                                height="40" />
                                                              <div>
                                                                <span class="fw-bold mt-0"><strong style="color:#fff;">
                                                                    {{ c.user.username }}</strong>

                                                                    {% if don_par_user.total_payments <= 10 %}
                                                                      <i class="fas fa-gem" style="color: #d39e00"></i>
                                                                      {% elif don_par_user.total_payments <= 15 %}
                                                                      <i class="fas fa-gem" style="color: #d39e00"></i>
                                                                      <i class="fas fa-gem" style="color: #d39e00"></i>
                                                                      {% elif don_par_user.total_payments <= 20 %}
                                                                      <i class="fas fa-gem" style="color: #d39e00"></i>
                                                                      <i class="fas fa-gem" style="color: #d39e00"></i>
                                                                      <i class="fas fa-gem" style="color: #d39e00"></i>
                                                                      {% elif don_par_user.total_payments > 20 %}
                                                                      <i class="fas fa-gem" style="color: #d39e00"></i>
                                                                      <i class="fas fa-gem" style="color: #d39e00"></i>
                                                                      <i class="fas fa-gem" style="color: #d39e00"></i>
                                                                      <i class="fas fa-gem" style="color: #d39e00"></i>
                                                                      {% endif %}
                                                                 <div class="mt-0" style="font-size: 10px">{{ c.date_added | date:"d/m/Y" }}|{{ c.date_added|time:"H:i:s" }}</div>
                                                                </span>
                                                                <div class="d-flex align-items-center mt-0 mb-0">


                                                                   <!-- <a href="#!" class="link-muted"><i class="bx bx-heart ms-2"></i></a>-->
                                                                </div>
                                                                <span style="color: #fdecdd;font-size: 14px;" class="mb-0">
                                                                  {{ c.contenue }}
                                                                </span>
                                                                  <!--<span id="repinput">
                                                                      <div class="d-flex flex-start mb-2">
                                                                      <img src="{{ user.photo.url }}" width="30" height="30" class="mt-1 rounded-circle shadow-1-strong me-3">
                                                                      <input  class="form-control"  placeholder="Votre reponse .." >
                                                                      <input class="btn rounded-pill btn-video" value="Repondre" type="submit">
                                                                  </div>
                                                                  </span>-->

                                                              </div>
                                                            </div>

                                                            <button id="like-button" style="background-color: #533f03;background-color: transparent"  data-comment-id="{{ c.pk }}" class="like-button btn rounded-pill btn-outline-secondary btn-xs align-content-center" >
                                                                <i class="fa fa-heart"></i>
                                                            </button>
                                                            <span id="likes-count-{{ c.id }}">{{ c.likes }}</span>

                                                            <script>
                                                            document.addEventListener("DOMContentLoaded", function() {
                                                                document.querySelectorAll(".like-button").forEach(function(button) {
                                                                    button.addEventListener("click", function() {
                                                                        var commentId = this.getAttribute("data-comment-id");
                                                                        var xhr = new XMLHttpRequest();
                                                                        xhr.open("POST", "/like_comment/" + commentId + "/");
                                                                        xhr.setRequestHeader("Content-Type", "application/json");
                                                                        xhr.setRequestHeader("X-CSRFToken", csrf_token);  // add CSRF token if using Django's built-in CSRF protection
                                                                        xhr.onload = function() {
                                                                            if (xhr.status === 200) {
                                                                                var response = JSON.parse(xhr.responseText);
                                                                                document.querySelector("#likes-count-" + commentId).innerHTML = response.likes;
                                                                            }
                                                                        };
                                                                        xhr.send();
                                                                    });
                                                                });
                                                            });
                                                            </script>
                                                            <hr style="color:#b9b7b7;" class="mb-3">
                                                          {% endif %}
                                                      {% endfor %}
                                                  </div>
                                                  <hr class="my-0" />
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                    </section>
                                </div>
                            </div>
                        {% endif %}
                        </div>
                    </div>
                        <!-- commentaires -->

                    </div>
                </div>
            {% endfor %}
            </div>
            </div>
            <div class="col-sm-12 col-md-12 col-xl-4">
                <div class="h-100 bg-secondary rounded p-4">
                    <div class="d-flex align-items-center justify-content-between mb-4">
                        <h6 class="mb-0">Recommandé</h6>
                        <a style="color: #B88E6D" href="{% url 'index' %}">Afficher tout</a>
                    </div>
                    <div>
                    {% for v in recpmanded_video %}
                    <div class="col-sm-12 col-xl-12">
                        <div class="rounded d-flex align-items-center justify-content-between h-100">
                            <div style="background-color: #191C24; " class="card h-100">
                            <a href="{% url 'video' v.id %}">

                                <video id="video" onclick="play();" width="100%" height="100%" class="card embed-responsive embed-responsive-16by9" poster="{{ v.miniature.url }}" >
                                    <source src="{{ v.vid.url }}#t={{ history.time_paused }}" type="video/mp4" />
                                </video>

                                <!--<form method="post">
                                  {% csrf_token %}
                                  <input type="submit" value="Pause">
                                </form>-->

                                <script>
                                  var video = document.getElementById("video");
                                  var form = document.querySelector("form");

                                  form.addEventListener("submit", function(event) {
                                    event.preventDefault();
                                    var time_paused = video.currentTime;
                                    var xhr = new XMLHttpRequest();
                                    xhr.open("POST", ".");
                                    xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
                                    xhr.send("time_paused=" + time_paused);
                                  });
                                </script>

                            </a>
                            <div class="row justify-content-between ">
                                <div style="margin-left: 0.5rem !important;" class="col-11 text-right mt-1">
                                    <a href="{% url 'video' v.id %}" class="text-white" style="overflow-wrap: break-word" title="{{ v.title }}">{{ v.title }}</a>
                                </div>
                            </div>
                            <span>
                                <div style="margin-left: 0.1rem" class="row">
                                <div class="col-2 mt-2">
                                    {% if v.miniature %}
                                    <div class="">
                                    {% if v.user.is_superuser %}
                                        <img id="img" width="35" src="{{ v.user.photo }}" class="rounded-circle">
                                        {% else %}
                                        <img id="img" width="35" src="{{ v.user.photo.url }}" class="rounded-circle">
                                        {% endif %}
                                    </div>
                                    {% endif %}
                                </div>
                                <div class="col-10">
                                    <span style="color:#A77443;">
                                        {{ v.user.username }} <i class="fas fa-check-circle"></i><br>
                                        <small>{{ v.views }} vues  {{ v.date_created.date|date:"d/m/Y" }}</small>
                                    </span>
                                </div>
                            </div>
                            </span>
                            </div>
                        </div>
                    </div>
                        <hr>
                    {% endfor %}

                    </div>
                </div>
            </div>
        </div>


{% endblock %}

{% include 'footer.html' %}
